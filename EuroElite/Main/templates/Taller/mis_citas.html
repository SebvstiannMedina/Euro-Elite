{% extends 'base.html' %}
{% load static %}
{% block title %}Mis citas - Euro Elite{% endblock %}
{% block content %}

<br><br><br><br><br><br>

<div class="container my-4 profile-wrapper">
  <div class="row">
    <!-- Sidebar -->
    <aside class="col-12 col-md-3 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="mb-1">Hola, <span id="greetingName">Alberto</span></h5>
          <p class="text-muted" style="font-size: .9rem;">Accede a toda la informaci&oacute;n de tu perfil</p>
          <div class="list-group list-group-flush mt-3">
            <a href="{% url 'perfil' %}" class="list-group-item list-group-item-action">
              <i class="fas fa-id-card me-2"></i> Mis datos
            </a>
            <a href="{% url 'nueva_contrasena' %}" class="list-group-item list-group-item-action">
              <i class="fas fa-lock me-2"></i> Contrase&ntilde;a
            </a>
            <a href="{% url 'mis_citas' %}" class="list-group-item list-group-item-action active">
              <i class="fas fa-calendar-alt me-2"></i> Mis citas
            </a>
            <a href="{% url 'mis_pedidos' %}" class="list-group-item list-group-item-action">
              <i class="fas fa-shopping-bag me-2"></i> Mis compras
            </a>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main content -->
    <section class="col-12 col-md-9" id="ordersSection">
      <div class="d-flex align-items-center justify-content-between mb-2">
        <h3 class="mb-0">Mis citas</h3>
      </div>

      <div class="card shadow-sm p-3">
        <div class="orders-wrapper">
        {% if citas %}
          {% for c in citas %}
            <div class="order-card shadow-sm">
              <div class="row align-items-center gy-3">
                <!-- Izquierda: imagen + resumen -->
                <div class="col-12 col-md-7 d-flex">
                  <div class="order-image-wrap">
                    <img src="{% static 'img/LogoApp.png' %}" alt="Cita" class="order-image">
                  </div>
                  <div class="ms-3 flex-grow-1">
                    <div class="small fw-semibold mb-1 {% if c.estado == 'COMPLETADA' %}text-success{% elif c.estado == 'CANCELADA' %}text-danger{% else %}text-primary{% endif %}">{{ c.get_estado_display }}</div>
                    <div class="order-title">Cita el {{ c.bloque.inicio|date:"j \\de F" }}</div>
                    <div class="order-subtitle">{{ c.servicio.nombre }}</div>
                    <div class="order-subtitle">{{ c.bloque.inicio|date:"H:i" }} - {{ c.bloque.fin|date:"H:i" }}</div>
                  </div>
                </div>

                <!-- Centro: modalidad -->
                <div class="col-12 col-md-3">
                  <div class="seller-name">{% if c.a_domicilio %}A domicilio{% else %}En taller{% endif %}</div>
                </div>

                <!-- Derecha: acciones -->
                <div class="col-12 col-md-2 order-actions text-md-end"></div>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <div class="empty-state text-center p-5 bg-white border rounded-3">
            <img src="{% static 'img/LogoApp.png' %}" alt="Euro Elite" style="width:72px;height:72px;opacity:.7;">
            <h5 class="mt-3 mb-1">A&uacute;n no tienes citas</h5>
            <p class="text-muted mb-3">Agenda tu primera visita con nuestros especialistas.</p>
            <a href="{% url 'agendar' %}" class="btn btn-primary btn-sm">Agendar ahora</a>
          </div>
        {% endif %}
        </div>
      </div>
    </section>
  </div>
</div>

<style>
  .profile-wrapper .card {
    border: 0;
    border-radius: 12px;
    box-shadow: var(--shadow);
    background: #fff;
  }
  .profile-wrapper .list-group-item { border: 0; }

  .orders-wrapper { margin-top: .5rem; }
  .date-separator { color: #6b7280; font-weight: 600; margin: 1.25rem 0 .5rem; }
  .order-card { background: #fff; border: 0; border-radius: 12px; padding: 16px; margin-bottom: 14px; }
  .order-image { width: 72px; height: 72px; object-fit: cover; border: 0; border-radius: 10px; background: #f8fafc; }
  #ordersSection .empty-state { border: 0 !important; }
  .order-title { font-weight: 600; font-size: 1.05rem; }
  .order-subtitle { color: #6b7280; font-size: .9rem; }
  .seller-name { font-size: .92rem; font-weight: 500; }
  .order-actions .btn { min-width: 140px; }
  @media (max-width: 767.98px) {
    .order-actions .btn { min-width: 100%; }
  }
</style>

{% endblock %}

